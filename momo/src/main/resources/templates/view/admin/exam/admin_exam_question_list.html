<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/admin_layout}">

<head>
	<!-- Select2 CSS -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
</head>
<th:block layout:fragment="customJsFile">
	<script src="https://code.jquery.com/jquery-3.7.1.js"
		integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
	<!-- Select2 JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

</th:block>
<th:block layout:fragment="customJs">
	<script th:inline="javascript">

		// Select2 초기화
		$('.js-example-basic-single').select2({
			minimumResultsForSearch: 0, // 검색 기능 활성화
			language: {
				noResults: function () {
					return "검색 결과가 없습니다"; // 사용자 정의 메시지
				}
			}
		});

		$('input').each((idx, element) => {
			if ($(element).val() == "미리보기") {
				$(element).click(function () {
					window.open('/admin/exam/questionPopup', '문제미리보기', 'width=600,height=800,scrollbars=yes');
				})
			}
		})
		$('#addQuestionBtn').click(function () {
			location.href = "/admin/exam/addQuestion"
		})
		$('#searchBtn').click(function () {

			const subMirCatCode = $('#subMirCatCode');
			const qnaScr = $('#qnaScr');
			const userCode = $('#userCode');
			const qnaCurExamState = $('#qnaCurExamState');
			const searchType = $('#searchType');
			const searchKeyword = $('#searchKeyword');

			const request = $.ajax({
				url: '/admin/exam/searchQuestionList',
				method: 'get',
				data: {
					'subMirCatCode': subMirCatCode,
					'qnaScr': qnaScr,
					'userCode': userCode,
					'qnaCurExamState': qnaCurExamState,
					'searchType': searchType,
					'searchKeyword': searchKeyword,
				},
				dataType: 'json'
			});
			request.done(function (data) {

				const searchList = data;



				$(searchList).each(function (idx, item) {


				});


			});
			request.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
		})
	</script>

</th:block>
<!-- layout.html 파일의 <div layout:fragment="content"> 영역에 들어가는 영역 -->
<div layout:fragment="content" id="examMain">

	<div class="sidebar">
		<div th:replace="fragments/admin/exam/sidebar :: sidebar"></div>
	</div>
	<div class="content" style="padding:0px">
		<div id="sys-breadcrumb">
			<button id="sys-breadcrumb-arrow" type="button">
				<i class="fa fa-minus" style="font-size: 12px;"></i>
			</button>
			<div id="sys-page-title">
				<span id="sys-page-title-nm">문제은행</span>
				<!-- <a id="sys-page-title-shortcut" href="javascript:addShortcut();"><i class="fa fa-star"></i></a> -->
				<button type="button" class="btn_simp yellow">
					<i class="fa fa-star"></i> 퀵메뉴추가
				</button>

			</div>
			<div id="sys-page-util">

				<a id="sys-page-util-refresh">
					<i class="fa fa-retweet"></i>
				</a>
			</div>
		</div>
		<div id="sys-wrap">
			<div id="sys-scroll">
				<div id="alert_area"></div>
				<div id="sys-contents">
					<table class="t_tb01" cellpadding="0" cellspacing="0" style="table-layout: fixed;">
						<colgroup>
							<col style="width: 120px;">
							<!-- 첫 번째 열의 너비를 120px로 설정 -->
							<col>
							<!-- 두 번째 열 (너비 기본값) -->
							<col style="width: 120px;">
							<!-- 세 번째 열의 너비를 120px로 설정 -->
							<col>
							<!-- 네 번째 열 (너비 기본값) -->
						</colgroup>
						<tbody>
							<tr>
								<td class="t_th01">카테고리</td>
								<td class="t_td01" colspan="3">
									<select name="subMirCatCode" class="js-example-basic-single" id="subMirCatCode">
										<option value=""> - 전체 - </option>
										<option th:if="${categoryList != null}" th:each="cl : ${categoryList}"
											th:text="${cl.subMirCatNm == '통합국어' || cl.subMirCatNm == '통합수학' || cl.subMirCatNm == '통합사회' || cl.subMirCatNm == '통합과학' ? cl.subMjrName + ' > (중등과정) ' + cl.subMirCatNm :(cl.subMjrName =='한국사')?cl.subMjrName + ' > ' + '한국사': cl.subMjrName + ' > ' + cl.subMirCatNm}"
											th:value="${cl.subMirCatCode}">
										</option>
									</select>
								</td>
							</tr>
							<tr>
								<td class="t_th01">문제 배점</td>
								<td class="t_td01" colspan="3">
									<label>
										<input type="radio" name="qnaScr" value="" class="ipt01" checked="" /> 전체
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaScr" value="1" class="ipt01" /> 1
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaScr" value="2" class="ipt01"> 2
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaScr" value="3" class="ipt01"> 3
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaScr" value="5" class="ipt01"> 4
									</label>
									&nbsp;
								</td>
							</tr>
							<tr>
								<td class="t_th01">출제자</td>
								<td class="t_td01">
									<select name="userCode" class="js-example-basic-single" id="userCode">
										<option value=""> - 전체 - </option>
										<option th:if="${userList !=null}" th:each="ul: ${userList}"
											th:text="'['+${ul.userId}+'] '+ ${ul.userName}" th:value="${ul.userCode}">
										</option>

									</select>
								</td>
								<td class="t_th01">상태</td>
								<td class="t_td01">
									<label>
										<input type="radio" name="qnaCurExamState" value="" class="ipt01" checked="" />
										전체
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaCurExamState" value="Y" class="ipt01" /> 사용
									</label>
									&nbsp;
									<label>
										<input type="radio" name="qnaCurExamState" value="N" class="ipt01"> 중지
									</label>
									&nbsp;
								</td>
							</tr>
							<tr>
								<td class="t_th01">검색</td>
								<td class="t_td01" colspan="3">
									<select name="searchType" id="searchType">
										<option value="">- 전체 -</option>
										<option value="qnaSubject">문제 제목</option>
										<option value="qnaQst">문제 내용</option>
										<option value="qnaChap">출제 단원</option>
										<option value="qnaType">출제 유형</option>
										<option value="qnaCmt">문제 해설</option>
									</select>
									<input type="text" name="searchKeyword" size="30" id="searchKeyword" />
									<button type="button" class="bttn2" id="searchBtn">검색</button>
								</td>
							</tr>
						</tbody>
					</table>

					<form name="form2" method="post" action="#" target="sysfrm">
						<input type="hidden" name="mode" value="status" />

						<table class="a_tb01" cellpadding="0" cellspacing="0" border="0">
							<tbody>
								<tr>
									<td class="a_th01">
										<span style="font-family: arial, dotum; font-weight: normal;">Total :
											<font color="blue">390</font> 건
										</span>
										&nbsp;&nbsp;
										<input type="button" value="전체문제 미리보기" class="btn_simp" />
									</td>
									<td class="a_td01">
										<button type="button" class="bttn2">일괄등록</button>
										<button type="button" class="bttn2" id="addQuestionBtn">등록</button>
										<button type="button" class="bttn2">EXCEL</button>
										<select name="a_status">
											<option value="">상태변경</option>
											<option value="1">사용</option>
											<option value="0">중지</option>
										</select>
									</td>
								</tr>
							</tbody>
						</table>

						<table class="l_tb01" cellpadding="0" cellspacing="0">
							<thead>
								<tr align="center">
									<td class="l_th01" width="20"><input type="checkbox" /></td>
									<td class="l_th01" width="80">No</td>
									<td class="l_th01"><span class="l_sort01" id="CL_a.question">문제</span></td>
									<td class="l_th01" width="80">미리보기</td>
									<td class="l_th01" width="80"><span class="l_sort01" id="CL_a.grade">문항배점</span>
									</td>

									<td class="l_th01" width="100"><span class="l_sort01" id="CL_u.user_nm">출제자</span>
									</td>
									<td class="l_th01" width="80"><span class="l_sort01" id="CL_a.status">상태</span></td>
									<td class="l_th01" width="80"><span class="l_sort01"
											id="CL_a.question_type">생성날짜</span></td>
									<td class="l_th01" width="80"><span class="l_sort01"
											id="CL_a.question_type">수정날짜</span></td>

								</tr>
							</thead>
							<tbody>
								<tr class="l_tr_even" align="center" th:if="${questionList !=null}"
									th:each="ql:${questionList}">
									<td class="l_td01"><input type="checkbox" name="idx" value="792" /></td>
									<td class="l_td01" th:text="${ql.qnaCode}">1</td>
									<td class="l_td01" align="left">
										<p class="cate01"
											th:text="(${ql.subMirCatNm !=null})?'['+${ql.subMjrCatNm}+' - '+${ql.subMirCatNm}+']':'['+${ql.subMjrCatNm}+']'">
										</p>
										<div style="float: left; margin-top: 4px;">
											<a href="#" target="_Main" th:text="${ql.qnaSubject}"> </a>
										</div>
									</td>
									<td class="l_td01"><input type="button" class="btn_simp" value="미리보기" /></td>
									<td class="l_td01" th:text="${ql.qnaScr}+'점'"></td>

									<td class="l_td01" align="center">
										<p class="label blue"
											style=" display: inline-block;padding:4px;font-weight: bolder;"
											th:text="${ql.userId}">
										</p>
										<br>
										<p th:text="${ql.userName}">홍길동</p>
									</td>
									<td class="l_td01"><span th:if="${ql.qnaCurExamState == 'Y'}"
											class="label green">사용</span>
										<span th:unless="${ql.qnaCurExamState == 'Y'}" class="label red">중지</span>
									</td>

									<td class="l_td01" th:text="${#dates.format(ql.qnaCreateTime, 'yy.MM.dd')}"></td>
									<td class="l_td01" th:text="${#dates.format(ql.qnaUpdateTime, 'yy.MM.dd')}"></td>

								</tr>


							</tbody>
						</table>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

</html>